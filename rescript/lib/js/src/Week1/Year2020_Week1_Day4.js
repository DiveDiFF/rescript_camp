// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Fs = require("fs");
var Js_dict = require("rescript/lib/js/js_dict.js");
var Belt_Int = require("rescript/lib/js/belt_Int.js");
var Belt_Array = require("rescript/lib/js/belt_Array.js");
var Belt_Option = require("rescript/lib/js/belt_Option.js");

var input = Fs.readFileSync("input/Week1/Year2020Day4.sample.txt", "utf8");

var inputList = Belt_Array.map(input.split("\n\n"), (function (passport) {
        return Js_dict.fromArray(Belt_Array.keepMap(Belt_Array.concatMany(Belt_Array.map(passport.split("\n"), (function (item) {
                                  return item.split(" ");
                                }))), (function (item) {
                          var match = item.split(":");
                          if (match.length !== 2) {
                            return ;
                          }
                          var key = match[0];
                          var value = match[1];
                          return [
                                  key,
                                  value
                                ];
                        })));
      }));

var validList = Belt_Array.keepMap(inputList, (function (dict) {
        var v = Belt_Int.fromString(Belt_Option.getWithDefault(Js_dict.get(dict, "byr"), ""));
        var match = v !== undefined ? v : undefined;
        var v$1 = Belt_Int.fromString(Belt_Option.getWithDefault(Js_dict.get(dict, "iyr"), ""));
        var match$1 = v$1 !== undefined ? v$1 : undefined;
        var v$2 = Belt_Int.fromString(Belt_Option.getWithDefault(Js_dict.get(dict, "eyr"), ""));
        var match$2 = v$2 !== undefined ? v$2 : undefined;
        var v$3 = Js_dict.get(dict, "hgt");
        var match$3 = v$3 !== undefined ? v$3 : undefined;
        var v$4 = Js_dict.get(dict, "hcl");
        var match$4 = v$4 !== undefined ? v$4 : undefined;
        var v$5 = Js_dict.get(dict, "ecl");
        var match$5 = v$5 !== undefined ? v$5 : undefined;
        var v$6 = Js_dict.get(dict, "pid");
        var match$6 = v$6 !== undefined ? v$6 : undefined;
        var match$7 = Js_dict.get(dict, "cid");
        if (match !== undefined && match$1 !== undefined && match$2 !== undefined && match$3 !== undefined && match$4 !== undefined && match$5 !== undefined && match$6 !== undefined) {
          return {
                  byr: match,
                  iyr: match$1,
                  eyr: match$2,
                  hgt: match$3,
                  hcl: match$4,
                  ecl: match$5,
                  pid: match$6,
                  cid: match$7
                };
        }
        
      }));

console.log(validList.length);

var strictValidList = Belt_Array.keepMap(validList, (function (passport) {
        var match = passport.byr >= 1920 && passport.byr <= 2002 ? passport.byr : undefined;
        var match$1 = passport.iyr >= 2010 && passport.iyr <= 2020 ? passport.iyr : undefined;
        var match$2 = passport.eyr >= 2020 && passport.eyr <= 2030 ? passport.eyr : undefined;
        var match$3 = passport.hgt.slice(-2);
        var match$4;
        switch (match$3) {
          case "cm" :
              var v = Belt_Int.fromString(passport.hgt.substring(0, passport.hgt.indexOf("c") + 1 | 0));
              match$4 = [
                v !== undefined && v >= 150 && v <= 193 ? v : undefined,
                /* Cm */0
              ];
              break;
          case "in" :
              var v$1 = Belt_Int.fromString(passport.hgt.substring(0, passport.hgt.indexOf("i") + 1 | 0));
              match$4 = [
                v$1 !== undefined && v$1 >= 59 && v$1 <= 76 ? v$1 : undefined,
                /* In */1
              ];
              break;
          default:
            match$4 = [
              undefined,
              undefined
            ];
        }
        var match$5 = /^\#[\d|a-f$]{6}/.test(passport.hcl) ? passport.hcl : undefined;
        var match$6 = passport.ecl;
        var match$7;
        switch (match$6) {
          case "amb" :
              match$7 = /* Amb */0;
              break;
          case "blu" :
              match$7 = /* Blu */1;
              break;
          case "brn" :
              match$7 = /* Brn */2;
              break;
          case "grn" :
              match$7 = /* Grn */4;
              break;
          case "gry" :
              match$7 = /* Gry */3;
              break;
          case "hzl" :
              match$7 = /* Hzl */5;
              break;
          case "oth" :
              match$7 = /* Oth */6;
              break;
          default:
            match$7 = undefined;
        }
        var match$8 = /[0-9]{9}/g.test(passport.pid) ? passport.pid : undefined;
        var match$9 = passport.cid;
        if (match === undefined) {
          return ;
        }
        if (match$1 === undefined) {
          return ;
        }
        if (match$2 === undefined) {
          return ;
        }
        var $$int = match$4[0];
        if ($$int === undefined) {
          return ;
        }
        var heightUnitType = match$4[1];
        if (heightUnitType !== undefined && match$5 !== undefined && match$7 !== undefined && match$8 !== undefined) {
          return {
                  byr: match,
                  iyr: match$1,
                  eyr: match$2,
                  hgt: [
                    $$int,
                    heightUnitType
                  ],
                  hcl: match$5,
                  ecl: match$7,
                  pid: match$8,
                  cid: match$9
                };
        }
        
      }));

console.log(strictValidList);

console.log(strictValidList.length);

exports.input = input;
exports.inputList = inputList;
exports.validList = validList;
exports.strictValidList = strictValidList;
/* input Not a pure module */
